version: '3'
services:
  file-db:
    image: 'postgres:10.5'
    environment:
      POSTGRES_PASSWORD: 123
#    volumes:
#      - full-share-file-db:/var/lib/postgresql/data
    ports:
      - '5432:5432'
    restart: always
    networks:
      nick-net:
        aliases:
        - file-db

  file-manager:
    depends_on:
      - file-db
    build: 'full-share/server/server/.'
    image: 'full-share-file-manager'
    volumes:
     - download-volume:/app/download
    restart: always
    networks:
      nick-net:
        aliases:
        - file-manager
    environment:
     - WEBSITE_DOMAIN=localhost:8080
     - WEBSITE_PROTOCOL=https://

  full-share-nginx:
    depends_on:
      - file-manager
    build:
      context: full-share/nginx
      dockerfile: Dockerfile-dev
    image: 'full-share-nginx'
    volumes:
     - ./full-share/web/build:/usr/share/nginx/html:ro
     - download-volume:/full-share/download:ro
    ports:
     - '8080:443'
    restart: always
    networks:
      nick-net:
        aliases:
        - full-share-nginx

networks:
  nick-net:

volumes:
  download-volume:
#  full-share-file-db: